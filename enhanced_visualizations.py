#!/usr/bin/env python3\n\"\"\"\nEnhanced Visualizations for GitHub API Rate Limit Tester\n\nCreates multiple engaging visualizations to showcase API performance data.\n\"\"\"\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport os\n\n# Set up professional styling\nplt.style.use('seaborn-v0_8-whitegrid')\nsns.set_palette(\"husl\")\n\ndef create_sample_visualizations():\n    \"\"\"Create sample visualizations for demonstration purposes.\"\"\"\n    \n    # Create sample data that mimics real API test results\n    np.random.seed(42)  # For reproducible results\n    \n    # Sample data structure\n    n_requests = 50\n    patterns = ['Burst'] * 15 + ['Sustained'] * 20 + ['Delayed'] * 15\n    \n    # Generate realistic response times\n    response_times = []\n    for i, pattern in enumerate(patterns):\n        if pattern == 'Burst':\n            # Burst pattern: fast initial responses, then slower\n            base_time = 100 + np.random.normal(0, 20)\n            if i < 5:\n                response_times.append(max(50, base_time))\n            else:\n                response_times.append(max(150, base_time + np.random.normal(50, 30)))\n        elif pattern == 'Sustained':\n            # Sustained pattern: consistent but slightly increasing\n            response_times.append(120 + np.random.normal(0, 25) + (i-15)*0.5)\n        else:\n            # Delayed pattern: slower but stable\n            response_times.append(180 + np.random.normal(0, 15))\n    \n    # Generate success/failure data\n    success = [True] * 45 + [False] * 5  # 90% success rate\n    np.random.shuffle(success)\n    \n    # Rate limit data\n    rate_limit_total = 5000\n    rate_limit_remaining = [rate_limit_total - i*100 for i in range(n_requests)]\n    \n    # Create DataFrame\n    df = pd.DataFrame({\n        'request_number': range(1, n_requests + 1),\n        'pattern': patterns,\n        'response_time_ms': response_times,\n        'success': success,\n        'rate_limit_remaining': rate_limit_remaining,\n        'rate_limit_limit': [rate_limit_total] * n_requests\n    })\n    \n    # Create visualizations directory\n    os.makedirs('visualizations', exist_ok=True)\n    \n    print(\"Creating enhanced visualizations...\")\n    \n    # 1. Performance Dashboard\n    create_performance_dashboard(df)\n    \n    # 2. Pattern Comparison\n    create_pattern_comparison(df)\n    \n    # 3. Rate Limit Analysis\n    create_rate_limit_analysis(df)\n    \n    # 4. Success Metrics\n    create_success_metrics(df)\n    \n    # 5. Timeline Analysis\n    create_timeline_analysis(df)\n    \n    print(\"âœ… All visualizations created in 'visualizations/' directory\")\n\n\ndef create_performance_dashboard(df):\n    \"\"\"Create a comprehensive performance dashboard.\"\"\"\n    fig, axes = plt.subplots(2, 2, figsize=(16, 12))\n    fig.suptitle('GitHub API Performance Dashboard', fontsize=20, fontweight='bold', \n                y=0.95, color='#2E4057')\n    \n    # Plot 1: Response Time Trend\n    axes[0, 0].plot(df['request_number'], df['response_time_ms'], \n                   linewidth=2.5, marker='o', markersize=4, \n                   color='#3498DB', alpha=0.8, markerfacecolor='#2980B9')\n    axes[0, 0].set_title('Response Time Trend', fontsize=14, fontweight='bold', \n                        color='#2C3E50')\n    axes[0, 0].set_xlabel('Request Sequence', fontsize=12)\n    axes[0, 0].set_ylabel('Response Time (ms)', fontsize=12)\n    axes[0, 0].grid(True, alpha=0.3)\n    axes[0, 0].fill_between(df['request_number'], df['response_time_ms'], \n                           alpha=0.2, color='#3498DB')\n    \n    # Add average line\n    avg_response = df['response_time_ms'].mean()\n    axes[0, 0].axhline(y=avg_response, color='#E74C3C', linestyle='--', \n                      linewidth=2, alpha=0.8, label=f'Avg: {avg_response:.1f}ms')\n    axes[0, 0].legend()\n    \n    # Plot 2: Rate Limit Usage\n    rate_limit_used = df['rate_limit_limit'].iloc[0] - df['rate_limit_remaining']\n    rate_limit_pct = (rate_limit_used / df['rate_limit_limit'].iloc[0]) * 100\n    \n    axes[0, 1].plot(df['request_number'], rate_limit_pct, \n                   linewidth=2.5, marker='s', markersize=4, \n                   color='#E67E22', alpha=0.8)\n    axes[0, 1].set_title('Rate Limit Usage Over Time', fontsize=14, fontweight='bold', \n                        color='#2C3E50')\n    axes[0, 1].set_xlabel('Request Sequence', fontsize=12)\n    axes[0, 1].set_ylabel('Rate Limit Used (%)', fontsize=12)\n    axes[0, 1].grid(True, alpha=0.3)\n    axes[0, 1].set_ylim(0, 100)\n    \n    # Add threshold lines\n    axes[0, 1].axhline(y=50, color='#F39C12', linestyle='--', alpha=0.7, \n                      label='50% Warning')\n    axes[0, 1].axhline(y=80, color='#E74C3C', linestyle='--', alpha=0.7, \n                      label='80% Critical')\n    axes[0, 1].legend()\n    \n    # Plot 3: Success Rate Over Time\n    df['success_cumulative'] = df['success'].cumsum() / (df.index + 1) * 100\n    axes[1, 0].plot(df['request_number'], df['success_cumulative'], \n                   linewidth=3, color='#27AE60', alpha=0.8)\n    axes[1, 0].set_title('Cumulative Success Rate', fontsize=14, fontweight='bold', \n                        color='#2C3E50')\n    axes[1, 0].set_xlabel('Request Sequence', fontsize=12)\n    axes[1, 0].set_ylabel('Success Rate (%)', fontsize=12)\n    axes[1, 0].grid(True, alpha=0.3)\n    axes[1, 0].set_ylim(0, 100)\n    \n    # Plot 4: Response Time Distribution\n    axes[1, 1].hist(df['response_time_ms'], bins=12, alpha=0.8, \n                   color='#9B59B6', edgecolor='#8E44AD', linewidth=1.2)\n    axes[1, 1].set_title('Response Time Distribution', fontsize=14, fontweight='bold', \n                        color='#2C3E50')\n    axes[1, 1].set_xlabel('Response Time (ms)', fontsize=12)\n    axes[1, 1].set_ylabel('Frequency', fontsize=12)\n    axes[1, 1].grid(True, alpha=0.3)\n    \n    plt.tight_layout()\n    plt.savefig('visualizations/performance_dashboard.png', dpi=300, \n               bbox_inches='tight', facecolor='white')\n    plt.close()\n\n\ndef create_pattern_comparison(df):\n    \"\"\"Create visualizations comparing different request patterns.\"\"\"\n    fig, axes = plt.subplots(2, 2, figsize=(16, 12))\n    fig.suptitle('Request Pattern Performance Comparison', fontsize=18, \n                fontweight='bold', color='#2E4057')\n    \n    # Colors for patterns\n    pattern_colors = {'Burst': '#3498DB', 'Sustained': '#27AE60', 'Delayed': '#E67E22'}\n    \n    # Plot 1: Response Times by Pattern (Box plot)\n    pattern_data = [df[df['pattern'] == p]['response_time_ms'] for p in pattern_colors.keys()]\n    \n    box_plot = axes[0, 0].boxplot(pattern_data, labels=pattern_colors.keys(), \n                                 patch_artist=True)\n    \n    # Color the boxes\n    for patch, color in zip(box_plot['boxes'], pattern_colors.values()):\n        patch.set_facecolor(color)\n        patch.set_alpha(0.7)\n    \n    axes[0, 0].set_title('Response Time Distribution by Pattern', \n                        fontsize=14, fontweight='bold', color='#2C3E50')\n    axes[0, 0].set_ylabel('Response Time (ms)', fontsize=12)\n    axes[0, 0].grid(True, alpha=0.3)\n    \n    # Plot 2: Success Rate by Pattern\n    success_rates = []\n    for pattern in pattern_colors.keys():\n        pattern_df = df[df['pattern'] == pattern]\n        success_rate = pattern_df['success'].mean() * 100\n        success_rates.append(success_rate)\n    \n    bars = axes[0, 1].bar(pattern_colors.keys(), success_rates, \n                         color=list(pattern_colors.values()), alpha=0.8)\n    axes[0, 1].set_title('Success Rate by Pattern', fontsize=14, fontweight='bold', \n                        color='#2C3E50')\n    axes[0, 1].set_ylabel('Success Rate (%)', fontsize=12)\n    axes[0, 1].set_ylim(0, 100)\n    axes[0, 1].grid(True, alpha=0.3)\n    \n    # Add value labels on bars\n    for bar, rate in zip(bars, success_rates):\n        height = bar.get_height()\n        axes[0, 1].text(bar.get_x() + bar.get_width()/2., height + 1,\n                       f'{rate:.1f}%', ha='center', va='bottom', fontweight='bold')\n    \n    # Plot 3: Pattern Timeline\n    for pattern, color in pattern_colors.items():\n        pattern_data = df[df['pattern'] == pattern]\n        axes[1, 0].scatter(pattern_data['request_number'], \n                          pattern_data['response_time_ms'], \n                          color=color, label=pattern, alpha=0.7, s=60)\n    \n    axes[1, 0].set_title('Response Times by Pattern Over Time', \n                        fontsize=14, fontweight='bold', color='#2C3E50')\n    axes[1, 0].set_xlabel('Request Sequence', fontsize=12)\n    axes[1, 0].set_ylabel('Response Time (ms)', fontsize=12)\n    axes[1, 0].legend()\n    axes[1, 0].grid(True, alpha=0.3)\n    \n    # Plot 4: Pattern Performance Summary\n    metrics = ['Avg Response Time', 'Success Rate', 'Requests']\n    pattern_metrics = {}\n    \n    for pattern in pattern_colors.keys():\n        pattern_df = df[df['pattern'] == pattern]\n        pattern_metrics[pattern] = [\n            pattern_df['response_time_ms'].mean(),\n            pattern_df['success'].mean() * 100,\n            len(pattern_df)\n        ]\n    \n    x = np.arange(len(metrics))\n    width = 0.25\n    multiplier = 0\n    \n    for pattern, metrics_data in pattern_metrics.items():\n        offset = width * multiplier\n        rects = axes[1, 1].bar(x + offset, metrics_data, width, \n                              label=pattern, color=pattern_colors[pattern], alpha=0.8)\n        multiplier += 1\n    \n    axes[1, 1].set_title('Pattern Performance Summary', fontsize=14, \n                        fontweight='bold', color='#2C3E50')\n    axes[1, 1].set_xticks(x + width)\n    axes[1, 1].set_xticklabels(metrics)\n    axes[1, 1].legend()\n    axes[1, 1].grid(True, alpha=0.3)\n    \n    plt.tight_layout()\n    plt.savefig('visualizations/pattern_comparison.png', dpi=300, \n               bbox_inches='tight', facecolor='white')\n    plt.close()\n\n\ndef create_rate_limit_analysis(df):\n    \"\"\"Create visualizations focused on rate limiting.\"\"\"\n    fig, axes = plt.subplots(2, 2, figsize=(16, 12))\n    fig.suptitle('Rate Limit Analysis', fontsize=18, fontweight='bold', \n                color='#2E4057')\n    \n    # Calculate rate limit usage\n    total_limit = df['rate_limit_limit'].iloc[0]\n    df['rate_limit_used'] = total_limit - df['rate_limit_remaining']\n    df['rate_limit_pct'] = (df['rate_limit_used'] / total_limit) * 100\n    \n    # Plot 1: Rate Limit Usage Over Time\n    axes[0, 0].plot(df['request_number'], df['rate_limit_pct'], \n                   linewidth=3, color='#E74C3C', marker='o', markersize=4)\n    axes[0, 0].set_title('Rate Limit Usage Over Time', fontsize=14, \n                        fontweight='bold', color='#2C3E50')\n    axes[0, 0].set_xlabel('Request Sequence', fontsize=12)\n    axes[0, 0].set_ylabel('Rate Limit Used (%)', fontsize=12)\n    axes[0, 0].grid(True, alpha=0.3)\n    axes[0, 0].set_ylim(0, 100)\n    \n    # Add threshold lines\n    axes[0, 0].axhline(y=50, color='#F39C12', linestyle='--', alpha=0.7, \n                      label='50% Warning')\n    axes[0, 0].axhline(y=80, color='#E74C3C', linestyle='--', alpha=0.7, \n                      label='80% Critical')\n    axes[0, 0].legend()\n    \n    # Plot 2: Rate Limit Allocation\n    requests_per_limit = len(df) / total_limit * 100\n    limit_data = [requests_per_limit, 100 - requests_per_limit]\n    labels = ['Used by Test', 'Remaining']\n    colors = ['#E74C3C', '#27AE60']\n    \n    wedges, texts, autotexts = axes[0, 1].pie(limit_data, labels=labels, \n                                             colors=colors, autopct='%1.1f%%', \n                                             startangle=90)\n    axes[0, 1].set_title('Rate Limit Allocation', fontsize=14, \n                        fontweight='bold', color='#2C3E50')\n    \n    # Style the pie chart\n    for autotext in autotexts:\n        autotext.set_color('white')\n        autotext.set_fontweight('bold')\n    \n    # Plot 3: Rate Limit vs Response Time\n    scatter = axes[1, 0].scatter(df['rate_limit_pct'], df['response_time_ms'], \n                               c=df['request_number'], cmap='viridis', \n                               alpha=0.7, s=60)\n    axes[1, 0].set_title('Rate Limit Usage vs Response Time', \n                        fontsize=14, fontweight='bold', color='#2C3E50')\n    axes[1, 0].set_xlabel('Rate Limit Used (%)', fontsize=12)\n    axes[1, 0].set_ylabel('Response Time (ms)', fontsize=12)\n    axes[1, 0].grid(True, alpha=0.3)\n    plt.colorbar(scatter, ax=axes[1, 0], label='Request Sequence')\n    \n    # Plot 4: Consumption Rate\n    df['consumption_rate'] = df['rate_limit_p